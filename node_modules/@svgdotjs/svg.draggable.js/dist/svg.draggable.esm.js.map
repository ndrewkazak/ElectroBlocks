{"version":3,"file":"svg.draggable.esm.js","sources":["../node_modules/@babel/runtime/helpers/esm/classCallCheck.js","../node_modules/@babel/runtime/helpers/esm/createClass.js","../src/svg.draggable.js"],"sourcesContent":["export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}","import { Box, Element, G, extend, off, on } from '@svgdotjs/svg.js'\n\nconst getCoordsFromEvent = ev => {\n  if (ev.changedTouches) {\n    ev = ev.changedTouches[0]\n  }\n  return { x: ev.clientX, y: ev.clientY }\n}\n\n// Creates handler, saves it\nclass DragHandler {\n  constructor (el) {\n    el.remember('_draggable', this)\n    this.el = el\n\n    this.drag = this.drag.bind(this)\n    this.startDrag = this.startDrag.bind(this)\n    this.endDrag = this.endDrag.bind(this)\n  }\n\n  // Enables or disabled drag based on input\n  init (enabled) {\n    if (enabled) {\n      this.el.on('mousedown.drag', this.startDrag)\n      this.el.on('touchstart.drag', this.startDrag, { passive: false })\n    } else {\n      this.el.off('mousedown.drag')\n      this.el.off('touchstart.drag')\n    }\n  }\n\n  // Start dragging\n  startDrag (ev) {\n    const isMouse = !ev.type.indexOf('mouse')\n\n    // Check for left button\n    if (isMouse && ev.which !== 1 && ev.buttons !== 0) {\n      return\n    }\n\n    // Fire beforedrag event\n    if (this.el.dispatch('beforedrag', { event: ev, handler: this }).defaultPrevented) {\n      return\n    }\n\n    // Prevent browser drag behavior as soon as possible\n    ev.preventDefault()\n\n    // Prevent propagation to a parent that might also have dragging enabled\n    ev.stopPropagation()\n\n    // Make sure that start events are unbound so that one element\n    // is only dragged by one input only\n    this.init(false)\n\n    this.box = this.el.bbox()\n    this.lastClick = this.el.point(getCoordsFromEvent(ev))\n\n    const eventMove = (isMouse ? 'mousemove' : 'touchmove') + '.drag'\n    const eventEnd = (isMouse ? 'mouseup' : 'touchend') + '.drag'\n\n    // Bind drag and end events to window\n    on(window, eventMove, this.drag, this, { passive: false })\n    on(window, eventEnd, this.endDrag, this, { passive: false })\n\n    // Fire dragstart event\n    this.el.fire('dragstart', { event: ev, handler: this, box: this.box })\n  }\n\n  // While dragging\n  drag (ev) {\n    const { box, lastClick } = this\n\n    const currentClick = this.el.point(getCoordsFromEvent(ev))\n    const dx = currentClick.x - lastClick.x\n    const dy = currentClick.y - lastClick.y\n\n    if (!dx && !dy) return box\n\n    const x = box.x + dx\n    const y = box.y + dy\n    this.box = new Box(x, y, box.w, box.h)\n    this.lastClick = currentClick\n\n    if (\n      this.el.dispatch('dragmove', {\n        event: ev,\n        handler: this,\n        box: this.box\n      }).defaultPrevented\n    ) {\n      return\n    }\n\n    this.move(x, y)\n  }\n\n  move (x, y) {\n    // Svg elements bbox depends on their content even though they have\n    // x, y, width and height - strange!\n    // Thats why we handle them the same as groups\n    if (this.el.type === 'svg') {\n      G.prototype.move.call(this.el, x, y)\n    } else {\n      this.el.move(x, y)\n    }\n  }\n\n  endDrag (ev) {\n    // final drag\n    this.drag(ev)\n\n    // fire dragend event\n    this.el.fire('dragend', { event: ev, handler: this, box: this.box })\n\n    // unbind events\n    off(window, 'mousemove.drag')\n    off(window, 'touchmove.drag')\n    off(window, 'mouseup.drag')\n    off(window, 'touchend.drag')\n\n    // Rebind initial Events\n    this.init(true)\n  }\n}\n\nextend(Element, {\n  draggable (enable = true) {\n    const dragHandler = this.remember('_draggable') || new DragHandler(this)\n    dragHandler.init(enable)\n    return this\n  }\n})\n"],"names":["getCoordsFromEvent","ev","changedTouches","x","clientX","y","clientY","DragHandler","el","remember","drag","bind","startDrag","endDrag","enabled","on","passive","off","isMouse","type","indexOf","which","buttons","dispatch","event","handler","defaultPrevented","preventDefault","stopPropagation","init","box","bbox","lastClick","point","eventMove","eventEnd","window","fire","currentClick","dx","dy","Box","w","h","move","G","prototype","call","extend","Element","draggable","enable","dragHandler"],"mappings":"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"}