{"version":3,"file":"svg.draggable.js","sources":["../node_modules/@babel/runtime/helpers/esm/classCallCheck.js","../node_modules/@babel/runtime/helpers/esm/createClass.js","../src/svg.draggable.js"],"sourcesContent":["export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}","import { Box, Element, G, extend, off, on } from '@svgdotjs/svg.js'\n\nconst getCoordsFromEvent = ev => {\n  if (ev.changedTouches) {\n    ev = ev.changedTouches[0]\n  }\n  return { x: ev.clientX, y: ev.clientY }\n}\n\n// Creates handler, saves it\nclass DragHandler {\n  constructor (el) {\n    el.remember('_draggable', this)\n    this.el = el\n\n    this.drag = this.drag.bind(this)\n    this.startDrag = this.startDrag.bind(this)\n    this.endDrag = this.endDrag.bind(this)\n  }\n\n  // Enables or disabled drag based on input\n  init (enabled) {\n    if (enabled) {\n      this.el.on('mousedown.drag', this.startDrag)\n      this.el.on('touchstart.drag', this.startDrag, { passive: false })\n    } else {\n      this.el.off('mousedown.drag')\n      this.el.off('touchstart.drag')\n    }\n  }\n\n  // Start dragging\n  startDrag (ev) {\n    const isMouse = !ev.type.indexOf('mouse')\n\n    // Check for left button\n    if (isMouse && ev.which !== 1 && ev.buttons !== 0) {\n      return\n    }\n\n    // Fire beforedrag event\n    if (this.el.dispatch('beforedrag', { event: ev, handler: this }).defaultPrevented) {\n      return\n    }\n\n    // Prevent browser drag behavior as soon as possible\n    ev.preventDefault()\n\n    // Prevent propagation to a parent that might also have dragging enabled\n    ev.stopPropagation()\n\n    // Make sure that start events are unbound so that one element\n    // is only dragged by one input only\n    this.init(false)\n\n    this.box = this.el.bbox()\n    this.lastClick = this.el.point(getCoordsFromEvent(ev))\n\n    const eventMove = (isMouse ? 'mousemove' : 'touchmove') + '.drag'\n    const eventEnd = (isMouse ? 'mouseup' : 'touchend') + '.drag'\n\n    // Bind drag and end events to window\n    on(window, eventMove, this.drag, this, { passive: false })\n    on(window, eventEnd, this.endDrag, this, { passive: false })\n\n    // Fire dragstart event\n    this.el.fire('dragstart', { event: ev, handler: this, box: this.box })\n  }\n\n  // While dragging\n  drag (ev) {\n    const { box, lastClick } = this\n\n    const currentClick = this.el.point(getCoordsFromEvent(ev))\n    const dx = currentClick.x - lastClick.x\n    const dy = currentClick.y - lastClick.y\n\n    if (!dx && !dy) return box\n\n    const x = box.x + dx\n    const y = box.y + dy\n    this.box = new Box(x, y, box.w, box.h)\n    this.lastClick = currentClick\n\n    if (\n      this.el.dispatch('dragmove', {\n        event: ev,\n        handler: this,\n        box: this.box\n      }).defaultPrevented\n    ) {\n      return\n    }\n\n    this.move(x, y)\n  }\n\n  move (x, y) {\n    // Svg elements bbox depends on their content even though they have\n    // x, y, width and height - strange!\n    // Thats why we handle them the same as groups\n    if (this.el.type === 'svg') {\n      G.prototype.move.call(this.el, x, y)\n    } else {\n      this.el.move(x, y)\n    }\n  }\n\n  endDrag (ev) {\n    // final drag\n    this.drag(ev)\n\n    // fire dragend event\n    this.el.fire('dragend', { event: ev, handler: this, box: this.box })\n\n    // unbind events\n    off(window, 'mousemove.drag')\n    off(window, 'touchmove.drag')\n    off(window, 'mouseup.drag')\n    off(window, 'touchend.drag')\n\n    // Rebind initial Events\n    this.init(true)\n  }\n}\n\nextend(Element, {\n  draggable (enable = true) {\n    const dragHandler = this.remember('_draggable') || new DragHandler(this)\n    dragHandler.init(enable)\n    return this\n  }\n})\n"],"names":["getCoordsFromEvent","ev","changedTouches","x","clientX","y","clientY","DragHandler","el","remember","drag","bind","startDrag","endDrag","enabled","on","passive","off","isMouse","type","indexOf","which","buttons","dispatch","event","handler","defaultPrevented","preventDefault","stopPropagation","init","box","bbox","lastClick","point","eventMove","eventEnd","window","fire","currentClick","dx","dy","Box","w","h","move","G","prototype","call","extend","Element","draggable","enable","dragHandler"],"mappings":";;;;;;;;;;;;;EAAe,SAAS,eAAe,CAAC,QAAQ,EAAE,WAAW,EAAE;EAC/D,EAAE,IAAI,EAAE,QAAQ,YAAY,WAAW,CAAC,EAAE;EAC1C,IAAI,MAAM,IAAI,SAAS,CAAC,mCAAmC,CAAC,CAAC;EAC7D,GAAG;EACH;;ECJA,SAAS,iBAAiB,CAAC,MAAM,EAAE,KAAK,EAAE;EAC1C,EAAE,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;EACzC,IAAI,IAAI,UAAU,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;EAC9B,IAAI,UAAU,CAAC,UAAU,GAAG,UAAU,CAAC,UAAU,IAAI,KAAK,CAAC;EAC3D,IAAI,UAAU,CAAC,YAAY,GAAG,IAAI,CAAC;EACnC,IAAI,IAAI,OAAO,IAAI,UAAU,EAAE,UAAU,CAAC,QAAQ,GAAG,IAAI,CAAC;EAC1D,IAAI,MAAM,CAAC,cAAc,CAAC,MAAM,EAAE,UAAU,CAAC,GAAG,EAAE,UAAU,CAAC,CAAC;EAC9D,GAAG;EACH,CAAC;AACD;EACe,SAAS,YAAY,CAAC,WAAW,EAAE,UAAU,EAAE,WAAW,EAAE;EAC3E,EAAE,IAAI,UAAU,EAAE,iBAAiB,CAAC,WAAW,CAAC,SAAS,EAAE,UAAU,CAAC,CAAC;EACvE,EAAE,IAAI,WAAW,EAAE,iBAAiB,CAAC,WAAW,EAAE,WAAW,CAAC,CAAC;EAC/D,EAAE,MAAM,CAAC,cAAc,CAAC,WAAW,EAAE,WAAW,EAAE;EAClD,IAAI,QAAQ,EAAE,KAAK;EACnB,GAAG,CAAC,CAAC;EACL,EAAE,OAAO,WAAW,CAAC;EACrB;;ECfA,IAAMA,kBAAkB,GAAG,SAArBA,kBAAqB,CAAAC,EAAE,EAAI;EAC/B,EAAIA,IAAAA,EAAE,CAACC,cAAP,EAAuB;EACrBD,IAAAA,EAAE,GAAGA,EAAE,CAACC,cAAH,CAAkB,CAAlB,CAAL,CAAA;EACD,GAAA;;EACD,EAAO,OAAA;EAAEC,IAAAA,CAAC,EAAEF,EAAE,CAACG,OAAR;EAAiBC,IAAAA,CAAC,EAAEJ,EAAE,CAACK,OAAAA;EAAvB,GAAP,CAAA;EACD,CALD;;;MAQMC;EACJ,EAAA,SAAA,WAAA,CAAaC,EAAb,EAAiB;EAAA,IAAA,eAAA,CAAA,IAAA,EAAA,WAAA,CAAA,CAAA;;EACfA,IAAAA,EAAE,CAACC,QAAH,CAAY,YAAZ,EAA0B,IAA1B,CAAA,CAAA;EACA,IAAKD,IAAAA,CAAAA,EAAL,GAAUA,EAAV,CAAA;EAEA,IAAKE,IAAAA,CAAAA,IAAL,GAAY,IAAKA,CAAAA,IAAL,CAAUC,IAAV,CAAe,IAAf,CAAZ,CAAA;EACA,IAAKC,IAAAA,CAAAA,SAAL,GAAiB,IAAKA,CAAAA,SAAL,CAAeD,IAAf,CAAoB,IAApB,CAAjB,CAAA;EACA,IAAKE,IAAAA,CAAAA,OAAL,GAAe,IAAKA,CAAAA,OAAL,CAAaF,IAAb,CAAkB,IAAlB,CAAf,CAAA;EACD;;;;;EAGD,IAAA,KAAA,EAAA,SAAA,IAAA,CAAMG,OAAN,EAAe;EACb,MAAA,IAAIA,OAAJ,EAAa;EACX,QAAA,IAAA,CAAKN,EAAL,CAAQO,EAAR,CAAW,gBAAX,EAA6B,KAAKH,SAAlC,CAAA,CAAA;EACA,QAAKJ,IAAAA,CAAAA,EAAL,CAAQO,EAAR,CAAW,iBAAX,EAA8B,IAAA,CAAKH,SAAnC,EAA8C;EAAEI,UAAAA,OAAO,EAAE,KAAA;EAAX,SAA9C,CAAA,CAAA;EACD,OAHD,MAGO;EACL,QAAA,IAAA,CAAKR,EAAL,CAAQS,GAAR,CAAY,gBAAZ,CAAA,CAAA;EACA,QAAA,IAAA,CAAKT,EAAL,CAAQS,GAAR,CAAY,iBAAZ,CAAA,CAAA;EACD,OAAA;EACF;;;;EAGD,IAAA,KAAA,EAAA,SAAA,SAAA,CAAWhB,EAAX,EAAe;EACb,MAAA,IAAMiB,OAAO,GAAG,CAACjB,EAAE,CAACkB,IAAH,CAAQC,OAAR,CAAgB,OAAhB,CAAjB,CADa;;EAIb,MAAA,IAAIF,OAAO,IAAIjB,EAAE,CAACoB,KAAH,KAAa,CAAxB,IAA6BpB,EAAE,CAACqB,OAAH,KAAe,CAAhD,EAAmD;EACjD,QAAA,OAAA;EACD,OANY;;;EASb,MAAA,IAAI,KAAKd,EAAL,CAAQe,QAAR,CAAiB,YAAjB,EAA+B;EAAEC,QAAAA,KAAK,EAAEvB,EAAT;EAAawB,QAAAA,OAAO,EAAE,IAAA;EAAtB,OAA/B,CAAA,CAA6DC,gBAAjE,EAAmF;EACjF,QAAA,OAAA;EACD,OAXY;;;EAcbzB,MAAAA,EAAE,CAAC0B,cAAH,EAAA,CAda;;EAiBb1B,MAAAA,EAAE,CAAC2B,eAAH,EAAA,CAjBa;EAoBb;;EACA,MAAKC,IAAAA,CAAAA,IAAL,CAAU,KAAV,CAAA,CAAA;EAEA,MAAA,IAAA,CAAKC,GAAL,GAAW,IAAA,CAAKtB,EAAL,CAAQuB,IAAR,EAAX,CAAA;EACA,MAAKC,IAAAA,CAAAA,SAAL,GAAiB,IAAA,CAAKxB,EAAL,CAAQyB,KAAR,CAAcjC,kBAAkB,CAACC,EAAD,CAAhC,CAAjB,CAAA;EAEA,MAAMiC,IAAAA,SAAS,GAAG,CAAChB,OAAO,GAAG,WAAH,GAAiB,WAAzB,IAAwC,OAA1D,CAAA;EACA,MAAMiB,IAAAA,QAAQ,GAAG,CAACjB,OAAO,GAAG,SAAH,GAAe,UAAvB,IAAqC,OAAtD,CA3Ba;;EA8BbH,MAAAA,SAAE,CAACqB,MAAD,EAASF,SAAT,EAAoB,IAAKxB,CAAAA,IAAzB,EAA+B,IAA/B,EAAqC;EAAEM,QAAAA,OAAO,EAAE,KAAA;EAAX,OAArC,CAAF,CAAA;EACAD,MAAAA,SAAE,CAACqB,MAAD,EAASD,QAAT,EAAmB,IAAKtB,CAAAA,OAAxB,EAAiC,IAAjC,EAAuC;EAAEG,QAAAA,OAAO,EAAE,KAAA;EAAX,OAAvC,CAAF,CA/Ba;;EAkCb,MAAA,IAAA,CAAKR,EAAL,CAAQ6B,IAAR,CAAa,WAAb,EAA0B;EAAEb,QAAAA,KAAK,EAAEvB,EAAT;EAAawB,QAAAA,OAAO,EAAE,IAAtB;EAA4BK,QAAAA,GAAG,EAAE,IAAKA,CAAAA,GAAAA;EAAtC,OAA1B,CAAA,CAAA;EACD;;;;EAGD,IAAA,KAAA,EAAA,SAAA,IAAA,CAAM7B,EAAN,EAAU;EACR,MAAA,IAAQ6B,GAAR,GAA2B,IAA3B,CAAQA,GAAR;EAAA,UAAaE,SAAb,GAA2B,IAA3B,CAAaA,SAAb,CAAA;EAEA,MAAMM,IAAAA,YAAY,GAAG,IAAA,CAAK9B,EAAL,CAAQyB,KAAR,CAAcjC,kBAAkB,CAACC,EAAD,CAAhC,CAArB,CAAA;EACA,MAAMsC,IAAAA,EAAE,GAAGD,YAAY,CAACnC,CAAb,GAAiB6B,SAAS,CAAC7B,CAAtC,CAAA;EACA,MAAMqC,IAAAA,EAAE,GAAGF,YAAY,CAACjC,CAAb,GAAiB2B,SAAS,CAAC3B,CAAtC,CAAA;EAEA,MAAA,IAAI,CAACkC,EAAD,IAAO,CAACC,EAAZ,EAAgB,OAAOV,GAAP,CAAA;EAEhB,MAAA,IAAM3B,CAAC,GAAG2B,GAAG,CAAC3B,CAAJ,GAAQoC,EAAlB,CAAA;EACA,MAAA,IAAMlC,CAAC,GAAGyB,GAAG,CAACzB,CAAJ,GAAQmC,EAAlB,CAAA;EACA,MAAA,IAAA,CAAKV,GAAL,GAAW,IAAIW,UAAJ,CAAQtC,CAAR,EAAWE,CAAX,EAAcyB,GAAG,CAACY,CAAlB,EAAqBZ,GAAG,CAACa,CAAzB,CAAX,CAAA;EACA,MAAKX,IAAAA,CAAAA,SAAL,GAAiBM,YAAjB,CAAA;;EAEA,MAAA,IACE,KAAK9B,EAAL,CAAQe,QAAR,CAAiB,UAAjB,EAA6B;EAC3BC,QAAAA,KAAK,EAAEvB,EADoB;EAE3BwB,QAAAA,OAAO,EAAE,IAFkB;EAG3BK,QAAAA,GAAG,EAAE,IAAKA,CAAAA,GAAAA;EAHiB,OAA7B,CAAA,CAIGJ,gBALL,EAME;EACA,QAAA,OAAA;EACD,OAAA;;EAED,MAAA,IAAA,CAAKkB,IAAL,CAAUzC,CAAV,EAAaE,CAAb,CAAA,CAAA;EACD,KAAA;;;aAED,SAAMF,IAAAA,CAAAA,CAAN,EAASE,CAAT,EAAY;EACV;EACA;EACA;EACA,MAAA,IAAI,KAAKG,EAAL,CAAQW,IAAR,KAAiB,KAArB,EAA4B;EAC1B0B,QAAAA,QAAC,CAACC,SAAF,CAAYF,IAAZ,CAAiBG,IAAjB,CAAsB,IAAKvC,CAAAA,EAA3B,EAA+BL,CAA/B,EAAkCE,CAAlC,CAAA,CAAA;EACD,OAFD,MAEO;EACL,QAAA,IAAA,CAAKG,EAAL,CAAQoC,IAAR,CAAazC,CAAb,EAAgBE,CAAhB,CAAA,CAAA;EACD,OAAA;EACF,KAAA;;;EAED,IAAA,KAAA,EAAA,SAAA,OAAA,CAASJ,EAAT,EAAa;EACX;EACA,MAAA,IAAA,CAAKS,IAAL,CAAUT,EAAV,CAAA,CAFW;;EAKX,MAAA,IAAA,CAAKO,EAAL,CAAQ6B,IAAR,CAAa,SAAb,EAAwB;EAAEb,QAAAA,KAAK,EAAEvB,EAAT;EAAawB,QAAAA,OAAO,EAAE,IAAtB;EAA4BK,QAAAA,GAAG,EAAE,IAAKA,CAAAA,GAAAA;EAAtC,OAAxB,EALW;;EAQXb,MAAAA,UAAG,CAACmB,MAAD,EAAS,gBAAT,CAAH,CAAA;EACAnB,MAAAA,UAAG,CAACmB,MAAD,EAAS,gBAAT,CAAH,CAAA;EACAnB,MAAAA,UAAG,CAACmB,MAAD,EAAS,cAAT,CAAH,CAAA;EACAnB,MAAAA,UAAG,CAACmB,MAAD,EAAS,eAAT,CAAH,CAXW;;EAcX,MAAKP,IAAAA,CAAAA,IAAL,CAAU,IAAV,CAAA,CAAA;EACD,KAAA;;;;;;AAGHmB,eAAM,CAACC,cAAD,EAAU;EACdC,EAAAA,SADc,EACY,SAAA,SAAA,GAAA;EAAA,IAAfC,IAAAA,MAAe,uEAAN,IAAM,CAAA;EACxB,IAAMC,IAAAA,WAAW,GAAG,IAAA,CAAK3C,QAAL,CAAc,YAAd,CAAA,IAA+B,IAAIF,WAAJ,CAAgB,IAAhB,CAAnD,CAAA;EACA6C,IAAAA,WAAW,CAACvB,IAAZ,CAAiBsB,MAAjB,CAAA,CAAA;EACA,IAAA,OAAO,IAAP,CAAA;EACD,GAAA;EALa,CAAV,CAAN;;;;;;"}