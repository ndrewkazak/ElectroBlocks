import{s as be,c as pe,p as de,n as je,b as ne,d as se}from"../chunks/scheduler.ydM6q-DU.js";import{S as ke,i as Ee,e as w,s as A,c as h,o as j,d as i,a as q,h as ye,f as b,b as _,t as y,k as Se,l as S,m as De,n as L,g as $e,p as M,q as B,r as T,u as V,v as re,w as Q,x as Y}from"../chunks/index.DrhsS78m.js";import{B as oe}from"../chunks/Button.C-6n3gZI.js";import{F as me}from"../chunks/FormGroup.D8-lUVa-.js";import{I as _e}from"../chunks/Input.BGMucF5x.js";import{L as ge}from"../chunks/Label.lKTK6TfW.js";import"../chunks/Theme.svelte_svelte_type_style_lang.B3rBZJtQ.js";import{a as Ie,b as Le,c as Me}from"../chunks/db.Dxj7bgAl.js";import{p as te}from"../chunks/project.store.DhP4I5K-.js";import{L as Te}from"../chunks/Login.erk-ihxl.js";import{F as Ve}from"../chunks/FlashMessage.ri9B07jr.js";import{w as Ae}from"../chunks/wait.CTNFjQS8.js";import{o as qe}from"../chunks/alerts.DcEBuQUd.js";import{w as Re}from"../chunks/block.helper.Dp3RpXvF.js";import{c as Fe}from"../chunks/code.store.ByWLoW46.js";import{c as J}from"../chunks/_commonjsHelpers.Cpj98o6Y.js";var we={exports:{}};(function(u,n){(function(t,s){s()})(J,function(){function t(e,r){return typeof r>"u"?r={autoBom:!1}:typeof r!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),r={autoBom:!r}),r.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\uFEFF",e],{type:e.type}):e}function s(e,r,v){var p=new XMLHttpRequest;p.open("GET",e),p.responseType="blob",p.onload=function(){o(p.response,r,v)},p.onerror=function(){console.error("could not download file")},p.send()}function m(e){var r=new XMLHttpRequest;r.open("HEAD",e,!1);try{r.send()}catch{}return 200<=r.status&&299>=r.status}function f(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(r)}}var l=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof J=="object"&&J.global===J?J:void 0,d=l.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),o=l.saveAs||(typeof window!="object"||window!==l?function(){}:"download"in HTMLAnchorElement.prototype&&!d?function(e,r,v){var p=l.URL||l.webkitURL,g=document.createElement("a");r=r||e.name||"download",g.download=r,g.rel="noopener",typeof e=="string"?(g.href=e,g.origin===location.origin?f(g):m(g.href)?s(e,r,v):f(g,g.target="_blank")):(g.href=p.createObjectURL(e),setTimeout(function(){p.revokeObjectURL(g.href)},4e4),setTimeout(function(){f(g)},0))}:"msSaveOrOpenBlob"in navigator?function(e,r,v){if(r=r||e.name||"download",typeof e!="string")navigator.msSaveOrOpenBlob(t(e,v),r);else if(m(e))s(e,r,v);else{var p=document.createElement("a");p.href=e,p.target="_blank",setTimeout(function(){f(p)})}}:function(e,r,v,p){if(p=p||open("","_blank"),p&&(p.document.title=p.document.body.innerText="downloading..."),typeof e=="string")return s(e,r,v);var g=e.type==="application/octet-stream",k=/constructor/i.test(l.HTMLElement)||l.safari,R=/CriOS\/[\d]+/.test(navigator.userAgent);if((R||g&&k||d)&&typeof FileReader<"u"){var E=new FileReader;E.onloadend=function(){var I=E.result;I=R?I:I.replace(/^data:[^;]*;/,"data:attachment/file;"),p?p.location.href=I:location=I,p=null},E.readAsDataURL(e)}else{var D=l.URL||l.webkitURL,c=D.createObjectURL(e);p?p.location=c:location.href=c,p=null,setTimeout(function(){D.revokeObjectURL(c)},4e4)}});l.saveAs=o.saveAs=o,u.exports=o})})(we);var ve=we.exports;function Pe(u){let n,t,s,m=`To Save project you must be logged in. If you don&#39;t want to login you
          can go to the
          <a href="/projects/download">download page</a>
          to download the code or project onto your computer.`,f,l,d;return l=new Te({}),{c(){n=w("div"),t=w("div"),s=w("p"),s.innerHTML=m,f=A(),L(l.$$.fragment),this.h()},l(o){n=h(o,"DIV",{class:!0});var e=j(n);t=h(e,"DIV",{class:!0});var r=j(t);s=h(r,"P",{"data-svelte-h":!0}),$e(s)!=="svelte-2vnygn"&&(s.innerHTML=m),f=q(r),M(l.$$.fragment,r),r.forEach(i),e.forEach(i),this.h()},h(){b(t,"class","col"),b(n,"class","row svelte-1ykk0qv")},m(o,e){_(o,n,e),B(n,t),B(t,s),B(t,f),T(l,t,null),d=!0},p:je,i(o){d||(S(l.$$.fragment,o),d=!0)},o(o){y(l.$$.fragment,o),d=!1},d(o){o&&i(n),V(l)}}}function Be(u){let n,t='<div class="col"><h2>Project Settings</h2></div>',s,m,f,l,d,o,e,r,v,p,g,k,R,E,D,c,I,U,H,C,F,Z,O,x,P,ee;l=new me({props:{$$slots:{default:[Oe]},$$scope:{ctx:u}}}),r=new me({props:{$$slots:{default:[Ce]},$$scope:{ctx:u}}}),k=new oe({props:{class:"w-100",color:"success",$$slots:{default:[xe]},$$scope:{ctx:u}}}),k.$on("click",u[4]);function he(a){u[9](a)}let ae={message:"Saved Project."};return u[0]!==void 0&&(ae.show=u[0]),c=new Ve({props:ae}),ne.push(()=>re(c,"show",he)),F=new oe({props:{class:"w-100",color:"info",$$slots:{default:[Ne]},$$scope:{ctx:u}}}),F.$on("click",u[6]),P=new oe({props:{class:"w-100",color:"info",$$slots:{default:[Ge]},$$scope:{ctx:u}}}),P.$on("click",u[5]),{c(){n=w("div"),n.innerHTML=t,s=A(),m=w("div"),f=w("div"),L(l.$$.fragment),d=A(),o=w("div"),e=w("div"),L(r.$$.fragment),v=A(),p=w("div"),g=w("div"),L(k.$$.fragment),R=A(),E=w("div"),D=w("div"),L(c.$$.fragment),U=A(),H=w("div"),C=w("div"),L(F.$$.fragment),Z=A(),O=w("div"),x=w("div"),L(P.$$.fragment),this.h()},l(a){n=h(a,"DIV",{class:!0,"data-svelte-h":!0}),$e(n)!=="svelte-xx28iu"&&(n.innerHTML=t),s=q(a),m=h(a,"DIV",{class:!0});var $=j(m);f=h($,"DIV",{class:!0});var N=j(f);M(l.$$.fragment,N),N.forEach(i),$.forEach(i),d=q(a),o=h(a,"DIV",{class:!0});var G=j(o);e=h(G,"DIV",{class:!0});var X=j(e);M(r.$$.fragment,X),X.forEach(i),G.forEach(i),v=q(a),p=h(a,"DIV",{class:!0});var K=j(p);g=h(K,"DIV",{class:!0});var W=j(g);M(k.$$.fragment,W),W.forEach(i),K.forEach(i),R=q(a),E=h(a,"DIV",{class:!0});var z=j(E);D=h(z,"DIV",{class:!0});var le=j(D);M(c.$$.fragment,le),le.forEach(i),z.forEach(i),U=q(a),H=h(a,"DIV",{class:!0});var ie=j(H);C=h(ie,"DIV",{class:!0});var ce=j(C);M(F.$$.fragment,ce),ce.forEach(i),ie.forEach(i),Z=q(a),O=h(a,"DIV",{class:!0});var ue=j(O);x=h(ue,"DIV",{class:!0});var fe=j(x);M(P.$$.fragment,fe),fe.forEach(i),ue.forEach(i),this.h()},h(){b(n,"class","row svelte-1ykk0qv"),b(f,"class","col"),b(m,"class","row svelte-1ykk0qv"),b(e,"class","col"),b(o,"class","row svelte-1ykk0qv"),b(g,"class","col"),b(p,"class","row svelte-1ykk0qv"),b(D,"class","col"),b(E,"class","row svelte-1ykk0qv"),b(C,"class","col"),b(H,"class","row svelte-1ykk0qv"),b(x,"class","col"),b(O,"class","row svelte-1ykk0qv")},m(a,$){_(a,n,$),_(a,s,$),_(a,m,$),B(m,f),T(l,f,null),_(a,d,$),_(a,o,$),B(o,e),T(r,e,null),_(a,v,$),_(a,p,$),B(p,g),T(k,g,null),_(a,R,$),_(a,E,$),B(E,D),T(c,D,null),_(a,U,$),_(a,H,$),B(H,C),T(F,C,null),_(a,Z,$),_(a,O,$),B(O,x),T(P,x,null),ee=!0},p(a,$){const N={};$&32770&&(N.$$scope={dirty:$,ctx:a}),l.$set(N);const G={};$&32772&&(G.$$scope={dirty:$,ctx:a}),r.$set(G);const X={};$&32768&&(X.$$scope={dirty:$,ctx:a}),k.$set(X);const K={};!I&&$&1&&(I=!0,K.show=a[0],se(()=>I=!1)),c.$set(K);const W={};$&32768&&(W.$$scope={dirty:$,ctx:a}),F.$set(W);const z={};$&32768&&(z.$$scope={dirty:$,ctx:a}),P.$set(z)},i(a){ee||(S(l.$$.fragment,a),S(r.$$.fragment,a),S(k.$$.fragment,a),S(c.$$.fragment,a),S(F.$$.fragment,a),S(P.$$.fragment,a),ee=!0)},o(a){y(l.$$.fragment,a),y(r.$$.fragment,a),y(k.$$.fragment,a),y(c.$$.fragment,a),y(F.$$.fragment,a),y(P.$$.fragment,a),ee=!1},d(a){a&&(i(n),i(s),i(m),i(d),i(o),i(v),i(p),i(R),i(E),i(U),i(H),i(Z),i(O)),V(l),V(r),V(k),V(c),V(F),V(P)}}}function He(u){let n;return{c(){n=Q("Name")},l(t){n=Y(t,"Name")},m(t,s){_(t,n,s)},d(t){t&&i(n)}}}function Oe(u){let n,t,s,m,f;n=new ge({props:{for:"project-name",$$slots:{default:[He]},$$scope:{ctx:u}}});function l(o){u[7](o)}let d={type:"text",name:"text",id:"project-name"};return u[1]!==void 0&&(d.value=u[1]),s=new _e({props:d}),ne.push(()=>re(s,"value",l)),{c(){L(n.$$.fragment),t=A(),L(s.$$.fragment)},l(o){M(n.$$.fragment,o),t=q(o),M(s.$$.fragment,o)},m(o,e){T(n,o,e),_(o,t,e),T(s,o,e),f=!0},p(o,e){const r={};e&32768&&(r.$$scope={dirty:e,ctx:o}),n.$set(r);const v={};!m&&e&2&&(m=!0,v.value=o[1],se(()=>m=!1)),s.$set(v)},i(o){f||(S(n.$$.fragment,o),S(s.$$.fragment,o),f=!0)},o(o){y(n.$$.fragment,o),y(s.$$.fragment,o),f=!1},d(o){o&&i(t),V(n,o),V(s,o)}}}function Ue(u){let n;return{c(){n=Q("Description")},l(t){n=Y(t,"Description")},m(t,s){_(t,n,s)},d(t){t&&i(n)}}}function Ce(u){let n,t,s,m,f;n=new ge({props:{for:"project-description",$$slots:{default:[Ue]},$$scope:{ctx:u}}});function l(o){u[8](o)}let d={type:"textarea",name:"text",id:"project-description"};return u[2]!==void 0&&(d.value=u[2]),s=new _e({props:d}),ne.push(()=>re(s,"value",l)),{c(){L(n.$$.fragment),t=A(),L(s.$$.fragment)},l(o){M(n.$$.fragment,o),t=q(o),M(s.$$.fragment,o)},m(o,e){T(n,o,e),_(o,t,e),T(s,o,e),f=!0},p(o,e){const r={};e&32768&&(r.$$scope={dirty:e,ctx:o}),n.$set(r);const v={};!m&&e&4&&(m=!0,v.value=o[2],se(()=>m=!1)),s.$set(v)},i(o){f||(S(n.$$.fragment,o),S(s.$$.fragment,o),f=!0)},o(o){y(n.$$.fragment,o),y(s.$$.fragment,o),f=!1},d(o){o&&i(t),V(n,o),V(s,o)}}}function xe(u){let n;return{c(){n=Q("Save")},l(t){n=Y(t,"Save")},m(t,s){_(t,n,s)},d(t){t&&i(n)}}}function Ne(u){let n;return{c(){n=Q("Download Project")},l(t){n=Y(t,"Download Project")},m(t,s){_(t,n,s)},d(t){t&&i(n)}}}function Ge(u){let n;return{c(){n=Q("Download Code")},l(t){n=Y(t,"Download Code")},m(t,s){_(t,n,s)},d(t){t&&i(n)}}}function Xe(u){let n,t,s,m,f;const l=[Be,Pe],d=[];function o(e,r){return e[3].isLoggedIn?0:1}return t=o(u),s=d[t]=l[t](u),{c(){n=w("main"),s.c(),m=A(),this.h()},l(e){n=h(e,"MAIN",{class:!0});var r=j(n);s.l(r),r.forEach(i),m=q(e),ye("svelte-1c5mfea",document.head).forEach(i),this.h()},h(){b(n,"class","container svelte-1ykk0qv"),document.title="ElectroBlocks - Project Settings"},m(e,r){_(e,n,r),d[t].m(n,null),_(e,m,r),f=!0},p(e,[r]){let v=t;t=o(e),t===v?d[t].p(e,r):(De(),y(d[v],1,1,()=>{d[v]=null}),Se(),s=d[t],s?s.p(e,r):(s=d[t]=l[t](e),s.c()),S(s,1),s.m(n,null))},i(e){f||(S(s),f=!0)},o(e){y(s),f=!1},d(e){e&&(i(n),i(m)),d[t].d()}}}function Ke(u,n,t){let s,m;pe(u,te,c=>t(12,s=c)),pe(u,Ie,c=>t(3,m=c));let f=!1,l="",d="",o=!0;const e=te.subscribe(c=>{c.project&&(t(1,l=c.project.name),t(2,d=c.project.description))});de(()=>{e&&e()});async function r(){if(o){o=!1;try{if(!s.projectId){const{projectId:I,project:U}=await Le({name:l,description:d,userId:m.uid,updated:null,created:null,canShare:!1});te.set({project:U,projectId:I}),t(0,f=!0),Ae(400),o=!0;return}const c={...s.project,name:l,description:d};await Me(c,s.projectId),te.set({projectId:s.projectId,project:c}),t(0,f=!0),o=!0}catch(c){qe("Please try again in 5 minutes",c),o=!0}}}let v,p=Fe.subscribe(c=>{v=c.code});function g(){const c=new Blob([v],{type:"text/plain;charset=utf-8"});ve.saveAs(c,"electroblocks_code.ino")}function k(){const c=new Blob([Re()],{type:"application/xml;charset=utf-8"});ve.saveAs(c,"electroblocks_project.xml")}de(()=>{p()});function R(c){l=c,t(1,l)}function E(c){d=c,t(2,d)}function D(c){f=c,t(0,f)}return[f,l,d,m,r,g,k,R,E,D]}class ut extends ke{constructor(n){super(),Ee(this,n,Ke,Xe,be,{})}}export{ut as component};
